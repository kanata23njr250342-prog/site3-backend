[build]
command = "npm run build"
functions = "netlify/functions"
publish = "dist"

[dev]
functions = "netlify/functions"

[context.production.environment]
SUPABASE_URL = "https://xspgrytduxbxurnaxzbq.supabase.co"
SUPABASE_ANON_KEY = "sb_publishable_mjTooh75pmd_IdYMizX4yA_rTiMwu2W"

[context.deploy-preview.environment]
SUPABASE_URL = "https://xspgrytduxbxurnaxzbq.supabase.co"
SUPABASE_ANON_KEY = "sb_publishable_mjTooh75pmd_IdYMizX4yA_rTiMwu2W"

# API ルーティング設定
[[redirects]]
from = "/api/notes/:category"
to = "/.netlify/functions/notes-get"
status = 200
force = true

[[redirects]]
from = "/api/notes"
to = "/.netlify/functions/notes-post"
status = 200
force = true

[[redirects]]
from = "/api/notes/:id"
to = "/.netlify/functions/notes-put"
status = 200
force = true

[[redirects]]
from = "/api/posts/:category"
to = "/.netlify/functions/posts-get"
status = 200
force = true

[[redirects]]
from = "/api/posts"
to = "/.netlify/functions/posts-post"
status = 200
force = true

[[redirects]]
from = "/api/posts/:id"
to = "/.netlify/functions/posts-put"
status = 200
force = true

[[redirects]]
from = "/api/posts/:id"
to = "/.netlify/functions/posts-delete"
status = 200
force = true
method = "DELETE"
