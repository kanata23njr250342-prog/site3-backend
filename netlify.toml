[build]
command = "npm run build"
publish = "dist"
# Netlify Functionsは使用していないため削除
# functions = "netlify/functions"

[build.environment]
# Supabase environment variables for build time
# These will be injected into the frontend build
VITE_SUPABASE_URL = "https://ddkmnuivyvuqqfvktrou.supabase.co"
VITE_SUPABASE_ANON_KEY = "sb_publishable_RoGIEnAS8977W74YIA5o_g_Ajol_JpW"
# Node.jsバージョンを明示的に指定（ビルド時間短縮）
NODE_VERSION = "20"

[dev]
# 開発環境ではFunctionsは不要
# functions = "netlify/functions"

# キャッシング設定（ビルド時間短縮）
[build.cache]
# node_modulesをキャッシュ
cache_dir = "node_modules"

# SPA用のキャッチオールリダイレクト
# すべてのルートをindex.htmlにリダイレクト
# フロントエンドはSupabaseと直接通信するため、Netlify Functionsへのリダイレクトは不要
[[redirects]]
from = "/*"
to = "/index.html"
status = 200

# キャッシュヘッダーの設定（静的アセットのキャッシュ）
[[headers]]
for = "/assets/*"
[headers.values]
Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
for = "/index.html"
[headers.values]
Cache-Control = "public, max-age=0, must-revalidate"

# 固定URLの設定（Facebook OGP等）
[[headers]]
for = "/"
[headers.values]
# OGP用のメタタグをキャッシュ
Cache-Control = "public, max-age=3600"
X-Frame-Options = "SAMEORIGIN"
X-Content-Type-Options = "nosniff"
X-XSS-Protection = "1; mode=block"
